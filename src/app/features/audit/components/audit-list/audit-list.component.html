
<div class="toolbar">
  <div class="search-filters">
    <input class="input" type="text" placeholder="Search by AuditID / Aircraft / Findings"
           [(ngModel)]="term" (input)="refresh()" />
    <input class="input" type="text" placeholder="Filter by AircraftID"
           [(ngModel)]="aircraftFilter" (input)="refresh()" />
    <button class="btn secondary" (click)="clear()">Reset</button>
  </div>

  <div style="display:flex; gap:.5rem;">
    <a class="btn" routerLink="/audit/new">+ New Audit</a>
    <button class="btn accent" (click)="export()">Export Compliance CSV</button>
  </div>
</div>

<div class="card">
  <table class="table audit-table">
    <thead>
      <tr>
        <th>Audit ID</th>
        <th>Aircraft ID</th>
        <th>Findings</th>
        <th>Status</th>
        <th>Audit Created</th>
        <th>Resolved On</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let x of logs; trackBy: trackByAuditId">
        <td>{{ x.auditID }}</td>
        <td>{{ x.aircraftID }}</td>
        <td><div class="findings-cell">{{ x.findings }}</div></td>

       
        <td class="status-cell">
          <select class="input status-select"
                  [(ngModel)]="x.status"
                  (ngModelChange)="onStatusSelect(x.auditID, $event)"
                  name="status-{{ x.auditID }}">
            <option [ngValue]="'PENDING'">PENDING</option>
            <option [ngValue]="'RESOLVED'">RESOLVED</option>
          </select>
        </td>

        <td class="date-cell">{{ x.date }}</td>
        <td class="date-cell">{{ x.resolvedDate || 'â€”' }}</td>

        <td class="actions-cell">
          
          <a class="btn secondary" [routerLink]="['/audit', x.auditID, 'edit']">Edit</a>
          <button class="btn danger" (click)="remove(x.auditID)">Delete</button>
        </td>
      </tr>

      <tr *ngIf="logs.length === 0">
        <td colspan="7" class="empty-row">No audit logs found</td>
      </tr>
    </tbody>
  </table>
</div>
