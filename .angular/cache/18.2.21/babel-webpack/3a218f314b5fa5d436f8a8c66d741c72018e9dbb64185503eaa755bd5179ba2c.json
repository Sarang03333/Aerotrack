{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nconst STORAGE_KEY = 'aerotrack.aircraft';\nexport let AircraftService = /*#__PURE__*/(() => {\n  class AircraftService {\n    constructor(http) {\n      this.http = http;\n      this._aircraft$ = new BehaviorSubject([]);\n      this.initialize();\n    }\n    initialize() {\n      const cached = localStorage.getItem(STORAGE_KEY);\n      if (cached) {\n        try {\n          this._aircraft$.next(JSON.parse(cached));\n          return;\n        } catch {}\n      }\n      this.http.get('assets/mock/aircraft.json').subscribe({\n        next: data => {\n          this._aircraft$.next(data);\n          this.persist();\n        },\n        error: () => {\n          this._aircraft$.next([{\n            aircraftID: 'AT-9001',\n            model: 'Mock Falcon',\n            category: 'Defense',\n            complianceStatus: 'Pending',\n            serviceHistory: []\n          }]);\n          this.persist();\n        }\n      });\n    }\n    list() {\n      return this._aircraft$.asObservable();\n    }\n    getValue() {\n      return this._aircraft$.getValue();\n    }\n    getById(id) {\n      return this.getValue().find(a => a.aircraftID === id);\n    }\n    ids() {\n      return this.getValue().map(a => a.aircraftID);\n    }\n    add(aircraft) {\n      const arr = this.getValue();\n      if (arr.some(a => a.aircraftID === aircraft.aircraftID)) throw new Error('AircraftID must be unique');\n      this._aircraft$.next([...arr, {\n        ...aircraft,\n        serviceHistory: aircraft.serviceHistory || []\n      }]);\n      this.persist();\n    }\n    update(id, changes) {\n      this._aircraft$.next(this.getValue().map(a => a.aircraftID === id ? {\n        ...a,\n        ...changes\n      } : a));\n      this.persist();\n    }\n    remove(id) {\n      this._aircraft$.next(this.getValue().filter(a => a.aircraftID !== id));\n      this.persist();\n    }\n    addServiceEvent(id, event) {\n      this._aircraft$.next(this.getValue().map(a => a.aircraftID === id ? {\n        ...a,\n        serviceHistory: [...a.serviceHistory, event]\n      } : a));\n      this.persist();\n    }\n    filter(term, category, compliance) {\n      const t = (term || '').toLowerCase();\n      return this.getValue().filter(a => {\n        const m1 = !t || a.aircraftID.toLowerCase().includes(t) || a.model.toLowerCase().includes(t);\n        const m2 = !category || a.category === category;\n        const m3 = !compliance || a.complianceStatus === compliance;\n        return m1 && m2 && m3;\n      });\n    }\n    persist() {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(this.getValue()));\n    }\n    static {\n      this.ɵfac = function AircraftService_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || AircraftService)(i0.ɵɵinject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: AircraftService,\n        factory: AircraftService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return AircraftService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}