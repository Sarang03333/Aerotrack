{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nconst STORAGE_KEY = 'aerotrack.spares';\nexport let SparesService = /*#__PURE__*/(() => {\n  class SparesService {\n    constructor(http) {\n      this.http = http;\n      this._parts$ = new BehaviorSubject([]);\n      this.initialize();\n    }\n    initialize() {\n      const cached = localStorage.getItem(STORAGE_KEY);\n      if (cached) {\n        try {\n          this._parts$.next(JSON.parse(cached));\n          return;\n        } catch {}\n      }\n      this.http.get('assets/mock/spares.json').subscribe({\n        next: d => {\n          this._parts$.next(d);\n          this.persist();\n        },\n        error: () => {\n          const fallback = [{\n            partID: 'SP-9001',\n            name: 'Hydraulic Pump',\n            quantityAvailable: 2,\n            reorderLevel: 5,\n            lastUpdated: new Date().toISOString().slice(0, 10)\n          }];\n          this._parts$.next(fallback);\n          this.persist();\n        }\n      });\n    }\n    list() {\n      return this._parts$.asObservable();\n    }\n    getValue() {\n      return this._parts$.getValue();\n    }\n    getById(id) {\n      return this.getValue().find(p => p.partID === id);\n    }\n    add(part) {\n      const arr = this.getValue();\n      if (arr.some(p => p.partID === part.partID)) throw new Error('PartID must be unique');\n      this._parts$.next([...arr, part]);\n      this.persist();\n    }\n    update(id, changes) {\n      this._parts$.next(this.getValue().map(p => p.partID === id ? {\n        ...p,\n        ...changes\n      } : p));\n      this.persist();\n    }\n    remove(id) {\n      this._parts$.next(this.getValue().filter(p => p.partID !== id));\n      this.persist();\n    }\n    isLowStock(p) {\n      return p.quantityAvailable <= p.reorderLevel;\n    }\n    replenish(id) {\n      // Mock vendor integration: simply set quantity to reorderLevel + 5 and update date\n      const updated = this.getValue().map(p => {\n        if (p.partID === id) {\n          return {\n            ...p,\n            quantityAvailable: Math.max(p.reorderLevel + 5, p.quantityAvailable),\n            lastUpdated: new Date().toISOString().slice(0, 10)\n          };\n        }\n        return p;\n      });\n      this._parts$.next(updated);\n      this.persist();\n    }\n    persist() {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(this.getValue()));\n    }\n    static {\n      this.ɵfac = function SparesService_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || SparesService)(i0.ɵɵinject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: SparesService,\n        factory: SparesService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return SparesService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}