{"ast":null,"code":"import { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { RouterModule } from '@angular/router';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../../core/services/audit.service\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"@angular/router\";\nconst _c0 = a0 => [\"/audit\", a0, \"edit\"];\nfunction AuditListComponent_tr_26_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r1 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\")(10, \"a\", 12);\n    i0.ɵɵtext(11, \"Edit\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"button\", 13);\n    i0.ɵɵlistener(\"click\", function AuditListComponent_tr_26_Template_button_click_12_listener() {\n      const x_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.resolve(x_r2.auditID));\n    });\n    i0.ɵɵtext(13, \"Mark Resolved\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"button\", 14);\n    i0.ɵɵlistener(\"click\", function AuditListComponent_tr_26_Template_button_click_14_listener() {\n      const x_r2 = i0.ɵɵrestoreView(_r1).$implicit;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.remove(x_r2.auditID));\n    });\n    i0.ɵɵtext(15, \"Delete\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const x_r2 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(x_r2.auditID);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(x_r2.aircraftID);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(x_r2.findings);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(x_r2.date);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(5, _c0, x_r2.auditID));\n  }\n}\nfunction AuditListComponent_tr_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\", 15);\n    i0.ɵɵtext(2, \"No audit logs found\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport let AuditListComponent = /*#__PURE__*/(() => {\n  class AuditListComponent {\n    constructor(svc) {\n      this.svc = svc;\n      this.term = '';\n      this.logs = [];\n      this.aircraftFilter = '';\n    }\n    ngOnInit() {\n      this.refresh();\n      this.svc.list().subscribe(() => this.refresh());\n    }\n    refresh() {\n      const t = (this.term || '').toLowerCase();\n      this.logs = this.svc.getValue().filter(x => {\n        const m1 = !t || x.auditID.toLowerCase().includes(t) || x.findings.toLowerCase().includes(t) || x.aircraftID.toLowerCase().includes(t);\n        const m2 = !this.aircraftFilter || x.aircraftID === this.aircraftFilter;\n        return m1 && m2;\n      });\n    }\n    clear() {\n      this.term = '';\n      this.aircraftFilter = '';\n      this.refresh();\n    }\n    remove(id) {\n      if (confirm(`Delete audit ${id}?`)) this.svc.remove(id);\n      this.refresh();\n    }\n    resolve(id) {\n      this.svc.markCorrectiveAction(id);\n      this.refresh();\n    }\n    export() {\n      const blob = this.svc.exportComplianceCSV();\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = 'compliance-report.csv';\n      a.click();\n      URL.revokeObjectURL(url);\n    }\n    static {\n      this.ɵfac = function AuditListComponent_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || AuditListComponent)(i0.ɵɵdirectiveInject(i1.AuditService));\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: AuditListComponent,\n        selectors: [[\"app-audit-list\"]],\n        standalone: true,\n        features: [i0.ɵɵStandaloneFeature],\n        decls: 28,\n        vars: 4,\n        consts: [[1, \"toolbar\"], [1, \"search-filters\"], [\"type\", \"text\", \"placeholder\", \"Search by AuditID / Aircraft / Findings\", 1, \"input\", 3, \"ngModelChange\", \"input\", \"ngModel\"], [\"type\", \"text\", \"placeholder\", \"Filter by AircraftID\", 1, \"input\", 3, \"ngModelChange\", \"input\", \"ngModel\"], [1, \"btn\", \"secondary\", 3, \"click\"], [2, \"display\", \"flex\", \"gap\", \".5rem\"], [\"routerLink\", \"/audit/new\", 1, \"btn\"], [1, \"btn\", \"accent\", 3, \"click\"], [1, \"card\"], [1, \"table\"], [4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [1, \"btn\", \"secondary\", 3, \"routerLink\"], [1, \"btn\", 3, \"click\"], [1, \"btn\", \"danger\", 3, \"click\"], [\"colspan\", \"5\", 2, \"text-align\", \"center\", \"color\", \"var(--muted)\"]],\n        template: function AuditListComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"input\", 2);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function AuditListComponent_Template_input_ngModelChange_2_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.term, $event) || (ctx.term = $event);\n              return $event;\n            });\n            i0.ɵɵlistener(\"input\", function AuditListComponent_Template_input_input_2_listener() {\n              return ctx.refresh();\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(3, \"input\", 3);\n            i0.ɵɵtwoWayListener(\"ngModelChange\", function AuditListComponent_Template_input_ngModelChange_3_listener($event) {\n              i0.ɵɵtwoWayBindingSet(ctx.aircraftFilter, $event) || (ctx.aircraftFilter = $event);\n              return $event;\n            });\n            i0.ɵɵlistener(\"input\", function AuditListComponent_Template_input_input_3_listener() {\n              return ctx.refresh();\n            });\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"button\", 4);\n            i0.ɵɵlistener(\"click\", function AuditListComponent_Template_button_click_4_listener() {\n              return ctx.clear();\n            });\n            i0.ɵɵtext(5, \"Reset\");\n            i0.ɵɵelementEnd()();\n            i0.ɵɵelementStart(6, \"div\", 5)(7, \"a\", 6);\n            i0.ɵɵtext(8, \"+ New Audit\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(9, \"button\", 7);\n            i0.ɵɵlistener(\"click\", function AuditListComponent_Template_button_click_9_listener() {\n              return ctx.export();\n            });\n            i0.ɵɵtext(10, \"Export Compliance CSV\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(11, \"div\", 8)(12, \"table\", 9)(13, \"thead\")(14, \"tr\")(15, \"th\");\n            i0.ɵɵtext(16, \"Audit ID\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(17, \"th\");\n            i0.ɵɵtext(18, \"Aircraft ID\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(19, \"th\");\n            i0.ɵɵtext(20, \"Findings\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(21, \"th\");\n            i0.ɵɵtext(22, \"Date\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(23, \"th\");\n            i0.ɵɵtext(24, \"Actions\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵelementStart(25, \"tbody\");\n            i0.ɵɵtemplate(26, AuditListComponent_tr_26_Template, 16, 7, \"tr\", 10)(27, AuditListComponent_tr_27_Template, 3, 0, \"tr\", 11);\n            i0.ɵɵelementEnd()()();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(2);\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.term);\n            i0.ɵɵadvance();\n            i0.ɵɵtwoWayProperty(\"ngModel\", ctx.aircraftFilter);\n            i0.ɵɵadvance(23);\n            i0.ɵɵproperty(\"ngForOf\", ctx.logs);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.logs.length === 0);\n          }\n        },\n        dependencies: [CommonModule, i2.NgForOf, i2.NgIf, FormsModule, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel, RouterModule, i4.RouterLink],\n        encapsulation: 2\n      });\n    }\n  }\n  return AuditListComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}