{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nconst STORAGE_KEY = 'aerotrack.maintenance';\nexport let MaintenanceService = /*#__PURE__*/(() => {\n  class MaintenanceService {\n    constructor(http) {\n      this.http = http;\n      this._tasks$ = new BehaviorSubject([]);\n      this.initialize();\n    }\n    initialize() {\n      const cached = localStorage.getItem(STORAGE_KEY);\n      if (cached) {\n        try {\n          this._tasks$.next(JSON.parse(cached));\n          return;\n        } catch {}\n      }\n      this.http.get('assets/mock/maintenance.json').subscribe({\n        next: data => {\n          this._tasks$.next(data);\n          this.persist();\n        },\n        error: () => {\n          this._tasks$.next([{\n            taskID: 'MT-9001',\n            aircraftID: 'AT-9001',\n            scheduledDate: new Date().toISOString().slice(0, 10),\n            status: 'PENDING'\n          }]);\n          this.persist();\n        }\n      });\n    }\n    list() {\n      return this._tasks$.asObservable();\n    }\n    getValue() {\n      return this._tasks$.getValue();\n    }\n    getById(id) {\n      return this.getValue().find(t => t.taskID === id);\n    }\n    add(task) {\n      const arr = this.getValue();\n      if (arr.some(t => t.taskID === task.taskID)) throw new Error('TaskID must be unique');\n      this._tasks$.next([...arr, task]);\n      this.persist();\n    }\n    update(id, changes) {\n      this._tasks$.next(this.getValue().map(t => t.taskID === id ? {\n        ...t,\n        ...changes\n      } : t));\n      this.persist();\n    }\n    remove(id) {\n      this._tasks$.next(this.getValue().filter(t => t.taskID !== id));\n      this.persist();\n    }\n    setStatus(id, status) {\n      this.update(id, {\n        status\n      });\n    }\n    filter(term, status) {\n      const t = (term || '').toLowerCase();\n      return this.getValue().filter(x => {\n        const m1 = !t || x.taskID.toLowerCase().includes(t) || x.aircraftID.toLowerCase().includes(t);\n        const m2 = !status || x.status === status;\n        return m1 && m2;\n      });\n    }\n    createEmergency(aircraftID) {\n      const id = `MT-${Math.floor(1000 + Math.random() * 9000)}`;\n      return {\n        taskID: id,\n        aircraftID,\n        scheduledDate: new Date().toISOString().slice(0, 10),\n        status: 'PENDING'\n      };\n    }\n    persist() {\n      localStorage.setItem(STORAGE_KEY, JSON.stringify(this.getValue()));\n    }\n    static {\n      this.ɵfac = function MaintenanceService_Factory(__ngFactoryType__) {\n        return new (__ngFactoryType__ || MaintenanceService)(i0.ɵɵinject(i1.HttpClient));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: MaintenanceService,\n        factory: MaintenanceService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return MaintenanceService;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}